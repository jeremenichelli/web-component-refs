!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.webComponentRefs=t()}(this,function(){"use strict";function e(e){return Array.prototype.slice.call(e)}function t(e){return e.nodeType&&1===e.nodeType&&(e.hasAttribute("ref")||"string"==typeof e.__refString__)}function o(e){var t=e.getAttribute("ref");this.refs[t]=e,e.__refString__=t,e.removeAttribute("ref")}return function(){if(void 0===this.shadowRoot)throw new Error("You must create a shadowRoot on the element");this.refs={};var i=this.shadowRoot.querySelectorAll("[ref]");i.length>0&&e(i).map(o.bind(this));new MutationObserver(function(i){i.map(function(i){e(i.addedNodes).filter(t).map(o.bind(this)),e(i.removedNodes).filter(t).map(function(e){delete this.refs[e.__refString__]}.bind(this))}.bind(this))}.bind(this)).observe(this.shadowRoot,{childList:!0,subtree:!0})}});